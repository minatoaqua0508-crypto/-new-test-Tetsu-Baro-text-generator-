var pageType="basepage";$(document).ready(function(){Body.hasClass("productdetail")&&$.productSpec(),$.fancyboxFunc(),$.updateCaptcha(),$.sendContact(),$.sideNav(),$.sharebtn(),$.ldTip(),$.searchProduct(),$.elevateZoom(),$.banner()}),function(t){t.updateCaptcha=function(){t("#captcha").click(function(){var a=new Date;t(this).attr("src","/captcha.php?"+a.getMilliseconds())})}}(jQuery),function(t){function a(a){var e="",i=/[\w-]+@([\w-]+\.)+[\w-]+/,c=/^09+[0-9]{8}$/,r=/(https?:\/\/)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&\/\/=]*)/;return t("input[name='requireField[]']").each(function(){var n=t(this).val();""===t("input[name="+n+"]").val()&&(e+=a.FIELD_IS_EMPTY.format(n)),""===t("textarea[name="+n+"]").val()&&(e+=a.FIELD_IS_EMPTY.format(n))}),""!==t("#mail").val()&&i.test(t("#mail").val())!==!0&&(e+=a.EMAIL_ERROR),"zh-TW"==t("html").attr("lang")&&"undefined"!=typeof t("#mobile").val()&&""!==t("#mobile").val()&&c.test(t("#mobile").val())!==!0&&(e+=a.MOBILE_ERROR),""!==t("#message").val()&&r.test(t("#message").val())===!0&&(e+=a.URL_BAN_ERROR),t("input[name=f_d_authcode]").length>0&&(""===t("input[name=f_d_authcode]").val()?e+=a.VERIFICODE_IS_EMPTY:t("#statepic").hasClass("success")||(e+=a.VERIFICODE_ERROR)),t("#g-recaptcha-response").length>0&&(n()||(e+=a.VERIFICODE_RECAPTCHA)),""===e||(alert(e),!1)}function n(){return""!==t("#g-recaptcha-response").val()}function e(){var a={t:"t",f:"d_captcha",f_d_authcode:t("input[name=f_d_authcode]").val()};t.ajax({type:"POST",url:location.pathname,dataType:"json",data:t.param(a),async:!1,beforeSend:function(){t("#state").html("<img src='/templates/images/loading.gif' class='error ajaxloading' style='vertical-align:middle;'>")},success:function(a){"success"==a.state?t("#state").html("<img id='statepic' src='/templates/images/captcha-right.png' class='success' style='vertical-align:middle;'>"):t("#state").html("<img id='statepic' src='/templates/images/captcha-error.png' class='error' style='vertical-align:middle;'>")},timeout:1e4})}var i={"zh-TW":{FIELD_IS_EMPTY:"{0} 不可以是空白。\n",EMAIL_ERROR:"信箱格式錯誤。\n",MOBILE_ERROR:"手機號碼格式錯誤，請輸入09開頭的10組數字。\n",VERIFICODE_IS_EMPTY:"驗證碼不可以是空白。\n",VERIFICODE_ERROR:"驗證碼錯誤。\n",VERIFICODE_RECAPTCHA:"請點選驗證機制。\n",URL_BAN_ERROR:"請勿傳送網址連結。\n"},"zh-CN":{FIELD_IS_EMPTY:"{0} 未填写。\n",EMAIL_ERROR:"信箱格式错误。\n",MOBILE_ERROR:"手机号码格式错误，请输入09开头的10组数字。\n",VERIFICODE_IS_EMPTY:"验证码不可以是空白。\n",VERIFICODE_ERROR:"验证码错误。\n",VERIFICODE_RECAPTCHA:"请点选验证机制。\n",URL_BAN_ERROR:"请勿传送网址连结。\n"},en:{FIELD_IS_EMPTY:"{0} cannot be empty.\n",EMAIL_ERROR:"Invalid email address.\n",MOBILE_ERROR:"Wrong format of phone number. Please enter 10 sets of numbers starting with 09.\n",VERIFICODE_IS_EMPTY:"Verification code cannot be empty.\n",VERIFICODE_ERROR:"Verification code is incorrect.\n",VERIFICODE_RECAPTCHA:"Click on the validation mechanism.\n",URL_BAN_ERROR:"Don't send links.\n"}};t.sendContact=function(){t("#contact-form").submit(function(){var n=t("#contact-form .submit.inputbtn")[0];n.disabled=!0,0==t("input[name=csrfToken]").length&&t("#contact-form").append("<input type='hidden' name='csrfToken'>"),t("input[name=csrfToken]").val(t('meta[name="csrf-token"]').attr("content"));var e=t(document.body).attr("lang"),c=i[e]||i["zh-TW"],r=a(c);return r||(n.disabled=!1),r}),t("#authcode").blur(function(){e()})}}(jQuery),function(t){function a(){var a={t:"t",f:"d_getspecpanel"};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(a),async:!1,success:function(a){var e=t("<div/>",{"class":"dd"});if(a.inves.length>1||"無規格"!==a.inves[0].spec){var c=t("<ol/>");t.each(a.inves,function(t,a){a.qty>0?(0===c.find("li.current").length&&(s=a.qty),c.append('<li data-inveid="{0}" {2}>{1}</li>'.format(a.id,a.spec,0===c.find("li.current").length?'class="current"':""))):c.append('<li data-inveid="{0}" title="缺貨" data-toggle="tooltip">{1}</li>'.format(a.id,a.spec))}),t("<li/>",{"class":"model"}).append("<b>"+a.lang.specification+"</b>").append(e.clone().attr("id","model-li").append(c)).insertBefore("#shopping-pay-way,#size-info,#shopping-means")}else s=a.inves[0].qty;if(0!==a.open){var r=t('<li class="quantity"><b>'+a.lang.quantity+'</b>                                        <div class="dd">                                            <input type="number" id="quantity" class="input-quantity" value="1" min="1">                                            <b>'+a.lang.inventory+'</b>                                            <span id="inventory"></span>                                        </div>                                    </li>                                    <li class="shopping-cart-btns">                                    </li>').insertBefore("#shopping-pay-way,#size-info,#shopping-means");o={quantityInput:r.find("#quantity"),inventory:r.find("#inventory"),cartBtn:t(".shopping-cart-btns")},n(a)}i(),e=null}})}function n(t){o.quantityInput.attr("max",s).prop("disabled",0===s),o.inventory.text(s),s>0&&2==t.open?o.cartBtn.html(r.prepare+" "+r.wantTrack):s>0?o.cartBtn.html(r.addCart+" "+r.wantTrack):0===s?o.cartBtn.html(r.empty+" "+r.waitTrack):o.cartBtn.html(r.empty+" "+r.wantTrack)}function e(){var a=window.location.pathname.match(/^\/product-detail-(\d+)/)[1],n=t("#breadcrumb li").map(function(a,n){t(n).children("a").text()}).get(),e=Number(t("#special-price").text()),i=Number(t("#quantity").val()),c={name:t("#productName").text(),category:n[n.length-2],id:a,price:e,variant:t("#model-li li.current").text(),currency:"TWD",quantity:i,subtotal:e*i};return c}function i(){t(".shopping-cart-btns").on("click","#add-to-cart",function(){var t=e();return d.addtoCart(),NDCEventDispatcher.addToCart(t),!1}),t(".shopping-cart-btns").on("click","#add-want-track",function(){var t=e();return d.addToTrack("want"),NDCEventDispatcher.addToWishlist(t),!1}),t(".shopping-cart-btns").on("click","#add-wait-track",function(){return d.addToTrack("wait"),!1}),t("#model-li").find("li").click(function(a){var n=t(this);if(!n.hasClass("current"))return c(a),!1})}function c(a){var e;e=void 0===a?t("#model-li li.current").data("inveid"):t(a.target).data("inveid");var i={t:"t",f:"d_getinventory",f_d_invid:e};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(i),async:!1,success:function(e){void 0!==a&&t(a.target).addClass("current").siblings().removeClass("current"),s=e.inventory,n(e)}})}var r={addCart:'<button type="button" id="add-to-cart" class="btn btn-cart"><i class="fa fa-shopping-cart fa-lg"></i> 放入購物車</button>',wantTrack:'<button type="button" id="add-want-track" class="btn btn-default">加入追蹤清單</button>',waitTrack:'<button type="button" id="add-wait-track" class="btn btn-default">加入到貨通知</button>',prepare:'<button type="button" class="btn btn-info" disabled="disabled">商品準備中</button>',empty:'<button type="button" class="btn btn-info" disabled="disabled">商品補貨中</button>'},o={},s=0,d={addtoCart:function(){if(t("#model-1").length>0&&t("#model-1 li.current").length<1)return e7notice("請選取商品規格","error"),!1;var a={t:"t",f:"d_getssluri"};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(a),success:function(a){t("<form/>").attr({method:"POST",action:a.location}).append('<input type="hidden" name="t" value="t">').append('<input type="hidden" name="f" value="d_addtocart">').append('<input type="hidden" name="f_d_invid" value="'+t("#model-li li.current").attr("data-inveid")+'">').append('<input type="hidden" name="f_d_quantity" value="'+t("#quantity").val()+'">').appendTo(document.body).submit()}})},addToTrack:function(a){var n={t:"t",f:"d_addtotrack",f_d_tracktype:a,f_d_invid:t("#model-li li.current").data("inveid")};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(n),async:!1,success:function(a){"success"===a.state?(t("#track-list").find(".badge").text(a.count),e7notice("商品已加入追蹤清單","success")):e7notice(a.error,"error")}})}};t.productSpec=function(){a()},t.extend(t.productSpec,{refreshModels:c})}(jQuery),function(t){(t("#bodyinpage").hasClass("product")||t("#bodyinpage").hasClass("shopping")||t("#bodyinpage").hasClass("globalshopping"))&&(pageType="fullpage"),t.sideNav=function(){t(".side-content").find(".children").prev("div").append("<span></span>").end().css({maxHeight:function(){var a=0;return t(this).find("li").each(function(){a+=t(this).outerHeight(!0)}),a?a+"px":"none"},transition:function(){return"max-height "+.1*t(this).find("li").length+"s cubic-bezier(0.15, 0, 0.15, 1)"}}).end().find(".current").addClass("open").parents("li").addClass("open").end().end().find("span").bind(Mouse.CLICK,function(){t(this).closest("li").toggleClass("open")}).end().parents(".main-container").addClass("left-menu")}}(jQuery),function(t){t.openQA=function(){t("#inquiry-btn").click(function(){return t("#inquiry-div").toggle(),!1}),t("#close-inquiry-div").click(function(){return t("#inquiry-div").hide(),!1});var a=t("#inquiry-div textarea").val();t("#inquiry-div textarea").focus(function(){t(this).val()==a&&t(this).val("").css("color","#000")}),t("#inquiry-div textarea").blur(function(){""===t(this).val()&&t(this).val(a).css("color","#777")})}}(jQuery),function(t){t.sharebtn=function(){t(".sharebtn").each(function(){t(this).click(function(a){if(t(this).hasClass("facebook"))window.open("http://www.facebook.com/share.php?u=".concat(encodeURIComponent(location.href)));else if(t(this).hasClass("twitter"))window.open("http://twitter.com/home/?status=".concat(encodeURIComponent(document.title)).concat(" ").concat(encodeURIComponent(location.href)));else if(t(this).hasClass("plurk"))window.open("http://www.plurk.com/?qualifier=shares&amp;status=".concat(encodeURIComponent(location.href)).concat(" ").concat("(").concat(encodeURIComponent(document.title)).concat(")"));else if("line"===t(this).attr("id")){a.preventDefault();var n="https://social-plugins.line.me/lineit/share?url="+encodeURIComponent(location.href)+"?utm_source=line&utm_medium=website&utm_campaign=click_share&openExternalBrowser=1&text="+encodeURIComponent(document.title);window.open(n,"_blank","width=550,height=420")}return!1})})}}(jQuery),function(t){function a(){t("#product-search-modal").modal()}function n(a){var n=!1;if("keypress"===a.type){var i="which"in a?a.which:a.keyCode;13===i&&(s=t(a.currentTarget).val(),n=!0)}"click"===a.type&&(s=t(a.currentTarget).prev("input").val(),n=!0),n===!0&&"product-keyword"!==t(a.currentTarget).attr("id")&&(t("#product-search-main > .product-keyword").val(s),t("#product-search-cates").empty(),t("#product-serach-msg").empty(),t("#product-search-result").empty(),t("#product-search-modal").modal("show"),t("#product-search-modal").on("shown.bs.modal",function(){e(s)})),n===!0&&"product-keyword"===t(a.currentTarget).attr("id")&&e(s)}function e(a){t("#product-serach-loading").removeClass("hidden"),t("#product-search-cates").empty(),t("#product-serach-msg").empty(),t("#product-search-result").empty(),"object"==typeof a&&(a=t("#product-search-main > .product-keyword").val()),setTimeout(function(){c(a)},100)}function i(a){a.preventDefault(),t.each(t(".list-group-item"),function(a,n){t(n).removeClass("active")}),t(a.currentTarget).addClass("active");var n=t(a.currentTarget).attr("data");if(void 0!==o.cates[n]){var e=t.extend({},o);e.cates={_cateId:e.cates[n]};var i=r(e);return void t("#product-search-result").empty().append(i)}var i=r(o);t("#product-search-result").empty().append(i)}function c(a){var n={t:"t",f:"d_getsearchresult",f_d_keyword:a};a?(NDCEventDispatcher.search(a),t.ajax({type:"POST",url:location.pathname,dataType:"json",data:t.param(n),async:!1,success:function(n){var e="",i="",c="「{0}」的搜尋結果 共 {1} 筆資料";if("success"===n.status&&void 0!==n.count){var s=t.extend({0:{id:"all",count:n.count,name:"全部結果"}},n.cates);t.each(s,function(a,n){var e='<a class="list-group-item" data="{0}" href="#">                                           <span class="badge">{1}</span> {2}                                           </a>';e=e.format(n.id,n.count,n.name),i+=e,t("#product-search-cates").html(i)}),c=c.format(a,n.count),t("#product-serach-msg").text(c),e=r(n),t("#product-search-result").html(e),o=n}"success"===n.status&&void 0===n.count&&(c=c.format(a,0),t("#product-serach-msg").html(c)),t("#product-serach-loading").addClass("hidden"),t.RWDNavToggle.hide()}})):Alert("請輸入關鍵字")}function r(a){var n="";return t.each(a.cates,function(a,e){t.each(e.products,function(t,a){var e='<li class="media">                                   <a href="{0}">                                       <div class="row">                                           <div class="col-xs-5 col-md-3">                                               <div class="media-img">                                                   <img src="{1}">                                               </div>                                           </div>                                           <div class="col-xs-7 col-md-9">                                               <h4>{2}</h4>                                           </div>                                       </div>                                   </a>                               </li>';e=e.format(a.filename,a.photo,a.name,a.price),n+=e})}),n}var o="",s="";t.searchProduct=function(){t(".searchbox").on("click",a),t("#product-search-main").on("click",'[type="submit"]',e),t("#product-search-main").on("keypress",'[type="text"]',n),t(".product-search").on("keypress",'[type="text"]',n),t(".product-search").on("click",'[type="submit"]',n),t("#product-search-cates").on("click","a.list-group-item",i)}}(jQuery),function(t){t.banner=function(){bannerGen.initIsPremium(),t("#banner > #banner-flash").length?bannerGen.flash():t("#banner > #banner-img").length&&bannerGen.swiper()}}(jQuery);